{{!
    @template local_jobboard/application_detail

    Application detail page template.

    Context variables:
    * id - Application ID
    * applicant - Applicant user info object
    * vacancy - Vacancy info object
    * status - Application status
    * statusclass - Status CSS class
    * timecreated - Submission date formatted
    * timemodified - Last modified date
    * documents - Array of documents
    * hasdocuments - Boolean
    * documentstats - Document statistics
    * timeline - Application timeline entries
    * hastimeline - Boolean
    * canreview - Can user review this application
    * canedit - Can user edit this application
    * reviewurl - URL to review
    * editurl - URL to edit
    * backurl - URL to go back
}}
<div class="jb-application-detail" data-application-id="{{id}}">
    {{> local_jobboard/components/breadcrumbs }}

    <div class="jb-card jb-mb-4">
        <div class="jb-card-header jb-d-flex jb-justify-content-between jb-align-items-start">
            <div>
                <span class="jb-badge jb-badge-{{statusclass}} jb-mr-2">{{#str}}appstatus:{{status}}, local_jobboard{{/str}}</span>
                <small class="jb-text-muted">{{#str}}application, local_jobboard{{/str}} #{{id}}</small>
            </div>
            <div class="jb-btn-group">
                {{#canedit}}
                <a href="{{editurl}}" class="jb-btn jb-btn-sm jb-btn-outline-secondary">
                    <i class="fa fa-edit jb-mr-1" aria-hidden="true"></i>
                    {{#str}}edit, local_jobboard{{/str}}
                </a>
                {{/canedit}}
                {{#canreview}}
                <a href="{{reviewurl}}" class="jb-btn jb-btn-sm jb-btn-primary">
                    <i class="fa fa-check-circle jb-mr-1" aria-hidden="true"></i>
                    {{#str}}review, local_jobboard{{/str}}
                </a>
                {{/canreview}}
            </div>
        </div>
        <div class="jb-card-body">
            <div class="jb-row">
                <div class="jb-col-md-6">
                    <h5>{{#str}}applicantinfo, local_jobboard{{/str}}</h5>
                    <div class="jb-d-flex jb-align-items-center jb-mb-3">
                        <img src="{{applicant.profileimageurl}}" alt="" class="jb-rounded-circle jb-mr-3" width="60" height="60">
                        <div>
                            <h6 class="jb-mb-0">{{applicant.fullname}}</h6>
                            <small class="jb-text-muted">{{applicant.email}}</small>
                        </div>
                    </div>
                    {{#applicant.phone}}
                    <p class="jb-mb-1"><i class="fa fa-phone jb-mr-2" aria-hidden="true"></i>{{applicant.phone}}</p>
                    {{/applicant.phone}}
                </div>
                <div class="jb-col-md-6">
                    <h5>{{#str}}vacancyinfo, local_jobboard{{/str}}</h5>
                    <p class="jb-mb-1">
                        <strong>{{vacancy.title}}</strong>
                        <span class="jb-badge jb-badge-secondary jb-ml-2">{{vacancy.code}}</span>
                    </p>
                    <p class="jb-mb-1 jb-text-muted">{{vacancy.department}}</p>
                    <a href="{{vacancy.url}}" class="jb-btn jb-btn-sm jb-btn-outline-primary jb-mt-2">
                        {{#str}}viewvacancy, local_jobboard{{/str}}
                    </a>
                </div>
            </div>

            <hr class="jb-my-4">

            <div class="jb-row">
                <div class="jb-col-md-4 jb-mb-3">
                    <small class="jb-text-muted jb-d-block">{{#str}}submitted, local_jobboard{{/str}}</small>
                    <strong>{{timecreated}}</strong>
                </div>
                <div class="jb-col-md-4 jb-mb-3">
                    <small class="jb-text-muted jb-d-block">{{#str}}lastmodified, local_jobboard{{/str}}</small>
                    <strong>{{timemodified}}</strong>
                </div>
                <div class="jb-col-md-4 jb-mb-3">
                    <small class="jb-text-muted jb-d-block">{{#str}}currentstatus, local_jobboard{{/str}}</small>
                    <span class="jb-badge jb-badge-{{statusclass}}">{{#str}}appstatus:{{status}}, local_jobboard{{/str}}</span>
                </div>
            </div>
        </div>
    </div>

    <div class="jb-row">
        <div class="jb-col-lg-8">
            <div class="jb-card jb-mb-4">
                <div class="jb-card-header jb-d-flex jb-justify-content-between jb-align-items-center">
                    <h5 class="jb-mb-0">{{#str}}documents, local_jobboard{{/str}}</h5>
                    {{#documentstats}}
                    <div>
                        <span class="jb-badge jb-badge-success" title="{{#str}}approved, local_jobboard{{/str}}">{{approved}}</span>
                        <span class="jb-badge jb-badge-warning" title="{{#str}}pending, local_jobboard{{/str}}">{{pending}}</span>
                        <span class="jb-badge jb-badge-danger" title="{{#str}}rejected, local_jobboard{{/str}}">{{rejected}}</span>
                    </div>
                    {{/documentstats}}
                </div>
                <div class="jb-card-body">
                    {{#hasdocuments}}
                    <div class="jb-table-responsive">
                        <table class="jb-table jb-table-sm">
                            <thead>
                                <tr>
                                    <th>{{#str}}documenttype, local_jobboard{{/str}}</th>
                                    <th>{{#str}}status, local_jobboard{{/str}}</th>
                                    <th>{{#str}}uploaded, local_jobboard{{/str}}</th>
                                    <th>{{#str}}actions, local_jobboard{{/str}}</th>
                                </tr>
                            </thead>
                            <tbody>
                                {{#documents}}
                                <tr>
                                    <td>{{doctypename}}</td>
                                    <td>
                                        <span class="jb-badge jb-badge-{{statusclass}}">{{#str}}docstatus:{{validationstatus}}, local_jobboard{{/str}}</span>
                                    </td>
                                    <td>{{timecreated}}</td>
                                    <td>
                                        <a href="{{viewurl}}" class="jb-btn jb-btn-sm jb-btn-outline-primary">
                                            <i class="fa fa-eye" aria-hidden="true"></i>
                                        </a>
                                        {{#canvalidate}}
                                        <a href="{{validateurl}}" class="jb-btn jb-btn-sm jb-btn-outline-success">
                                            <i class="fa fa-check" aria-hidden="true"></i>
                                        </a>
                                        {{/canvalidate}}
                                    </td>
                                </tr>
                                {{/documents}}
                            </tbody>
                        </table>
                    </div>
                    {{/hasdocuments}}
                    {{^hasdocuments}}
                    <p class="jb-text-muted jb-text-center">{{#str}}nodocuments, local_jobboard{{/str}}</p>
                    {{/hasdocuments}}
                </div>
            </div>
        </div>

        <div class="jb-col-lg-4">
            <div class="jb-card">
                <div class="jb-card-header">
                    <h5 class="jb-mb-0">{{#str}}timeline, local_jobboard{{/str}}</h5>
                </div>
                <div class="jb-card-body">
                    {{#hastimeline}}
                    {{> local_jobboard/application_timeline }}
                    {{/hastimeline}}
                    {{^hastimeline}}
                    <p class="jb-text-muted jb-text-center">{{#str}}notimeline, local_jobboard{{/str}}</p>
                    {{/hastimeline}}
                </div>
            </div>
        </div>
    </div>

    <div class="jb-mt-4">
        <a href="{{backurl}}" class="jb-btn jb-btn-outline-secondary">
            <i class="fa fa-arrow-left jb-mr-1" aria-hidden="true"></i>
            {{#str}}back, local_jobboard{{/str}}
        </a>
    </div>
</div>
