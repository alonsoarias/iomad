{{!
    @template local_jobboard/pages/apply

    Apply for vacancy page template.

    Context variables:
    * pageheader - Page header data
    * vacancy - Vacancy information
    * deadlinewarning - Warning if close to deadline
    * daysuntilclose - Days until closing
    * guidelines - Array of application guideline strings
    * isexemption - Boolean if user has exemption
    * exemptioninfo - Exemption details if applicable
    * requireddocs - Array of required documents
    * form - Moodle form HTML

    Example context (json):
    {
        "vacancy": {"id": 1, "title": "Developer"},
        "daysuntilclose": 5,
        "deadlinewarning": true
    }
}}
<div class="local-jobboard-apply" data-region="jobboard-apply">
    {{! Page Header }}
    {{> local_jobboard/components/page_header }}

    <div class="row">
        {{! Left Column - Form }}
        <main class="col-lg-8">
            {{! Deadline Warning }}
            {{#deadlinewarning}}
            <div class="alert alert-warning mb-4" role="alert">
                <i class="fa fa-exclamation-triangle mr-2" aria-hidden="true"></i>
                <strong>{{#str}}warning, local_jobboard{{/str}}:</strong>
                {{#str}}deadlinewarning, local_jobboard, {{daysuntilclose}}{{/str}}
            </div>
            {{/deadlinewarning}}

            {{! Exemption Info }}
            {{#isexemption}}
            <div class="alert alert-info mb-4" role="status">
                <i class="fa fa-info-circle mr-2" aria-hidden="true"></i>
                <strong>{{#str}}exemptionapplied, local_jobboard{{/str}}</strong>
                <p class="mb-0 mt-2">
                    {{#str}}exemptiontype, local_jobboard{{/str}}: {{exemptioninfo.type}}<br>
                    {{#exemptioninfo.documentref}}
                    {{#str}}documentref, local_jobboard{{/str}}: {{exemptioninfo.documentref}}
                    {{/exemptioninfo.documentref}}
                </p>
            </div>
            {{/isexemption}}

            {{! Guidelines Card }}
            <section class="card shadow-sm mb-4" aria-labelledby="guidelines-heading">
                <div class="card-header bg-light">
                    <h2 class="h5 mb-0" id="guidelines-heading">
                        <i class="fa fa-info-circle mr-2" aria-hidden="true"></i>
                        {{#str}}applicationguidelines, local_jobboard{{/str}}
                    </h2>
                </div>
                <div class="card-body jb-content-area">
                    <ul class="mb-0">
                        {{#guidelines}}
                        <li>{{.}}</li>
                        {{/guidelines}}
                    </ul>
                </div>
            </section>

            {{! Required Documents Card }}
            {{#requireddocs.0}}
            <section class="card shadow-sm mb-4" aria-labelledby="docs-heading">
                <div class="card-header bg-light">
                    <h2 class="h5 mb-0" id="docs-heading">
                        <i class="fa fa-file-alt mr-2" aria-hidden="true"></i>
                        {{#str}}requireddocuments, local_jobboard{{/str}}
                    </h2>
                </div>
                <div class="card-body">
                    <ul class="list-group list-group-flush" role="list">
                        {{#requireddocs}}
                        <li class="list-group-item d-flex justify-content-between align-items-center px-0" role="listitem">
                            <div>
                                <strong>{{name}}</strong>
                                {{#description}}
                                <small class="text-muted d-block">{{description}}</small>
                                {{/description}}
                            </div>
                            {{#isrequired}}
                            <span class="badge badge-danger" aria-label="{{#str}}required, local_jobboard{{/str}}">
                                {{#str}}required, local_jobboard{{/str}}
                            </span>
                            {{/isrequired}}
                            {{^isrequired}}
                            <span class="badge badge-secondary" aria-label="{{#str}}optional, local_jobboard{{/str}}">
                                {{#str}}optional, local_jobboard{{/str}}
                            </span>
                            {{/isrequired}}
                        </li>
                        {{/requireddocs}}
                    </ul>
                </div>
            </section>
            {{/requireddocs.0}}

            {{! Application Form Card }}
            <section class="card shadow-sm mb-4" aria-labelledby="form-heading">
                <div class="card-header bg-primary text-white">
                    <h2 class="h5 mb-0" id="form-heading">
                        <i class="fa fa-edit mr-2" aria-hidden="true"></i>
                        {{#str}}applicationform, local_jobboard{{/str}}
                    </h2>
                </div>
                <div class="card-body">
                    {{{form}}}
                </div>
            </section>
        </main>

        {{! Right Column - Vacancy Info }}
        <aside class="col-lg-4">
            {{! Vacancy Summary Card }}
            <section class="card shadow-sm mb-4 sticky-top jb-sidebar-card" aria-labelledby="vacancy-summary-heading">
                <div class="card-header bg-dark text-white">
                    <h2 class="h6 mb-0" id="vacancy-summary-heading">
                        <i class="fa fa-briefcase mr-2" aria-hidden="true"></i>
                        {{#str}}vacancysummary, local_jobboard{{/str}}
                    </h2>
                </div>
                <div class="card-body">
                    <p class="mb-1">
                        <strong>{{vacancy.title}}</strong>
                    </p>
                    <p class="text-muted small mb-2">
                        <span class="badge badge-secondary" aria-label="{{#str}}vacancycode, local_jobboard{{/str}}: {{vacancy.code}}">{{vacancy.code}}</span>
                    </p>

                    <dl class="jb-definition-list mb-0">
                        {{#vacancy.location}}
                        <dt class="sr-only">{{#str}}location, local_jobboard{{/str}}</dt>
                        <dd class="small mb-1">
                            <i class="fa fa-map-marker-alt text-muted mr-2" aria-hidden="true"></i>{{vacancy.location}}
                        </dd>
                        {{/vacancy.location}}

                        {{#vacancy.contracttypelabel}}
                        <dt class="sr-only">{{#str}}contracttype, local_jobboard{{/str}}</dt>
                        <dd class="small mb-1">
                            <i class="fa fa-briefcase text-muted mr-2" aria-hidden="true"></i>{{vacancy.contracttypelabel}}
                        </dd>
                        {{/vacancy.contracttypelabel}}

                        <dt class="sr-only">{{#str}}positions, local_jobboard{{/str}}</dt>
                        <dd class="small mb-2">
                            <i class="fa fa-users text-muted mr-2" aria-hidden="true"></i>
                            {{#str}}positions, local_jobboard{{/str}}: {{vacancy.positions}}
                        </dd>
                    </dl>

                    <hr>

                    <p class="small mb-1 {{#vacancy.isurgent}}text-warning font-weight-bold{{/vacancy.isurgent}}">
                        <i class="fa fa-calendar-times mr-2" aria-hidden="true"></i>
                        {{#str}}closedate, local_jobboard{{/str}}: <strong>{{vacancy.closedateformatted}}</strong>
                    </p>

                    {{#vacancy.isurgent}}
                    <div class="alert alert-warning py-2 px-3 mb-0 small" role="alert">
                        <i class="fa fa-exclamation-triangle mr-1" aria-hidden="true"></i>
                        {{#str}}closesin, local_jobboard, {{vacancy.daysremaining}}{{/str}}
                    </div>
                    {{/vacancy.isurgent}}
                </div>

                {{#vacancy.viewurl}}
                <footer class="card-footer bg-light">
                    <a href="{{vacancy.viewurl}}" class="btn btn-sm btn-outline-secondary btn-block" aria-label="{{#str}}viewvacancy, local_jobboard{{/str}}: {{vacancy.title}}">
                        <i class="fa fa-eye mr-1" aria-hidden="true"></i>
                        {{#str}}viewvacancy, local_jobboard{{/str}}
                    </a>
                </footer>
                {{/vacancy.viewurl}}
            </section>

            {{! Help Card }}
            <section class="card shadow-sm mb-4" aria-labelledby="help-heading">
                <div class="card-header bg-light">
                    <h2 class="h6 mb-0" id="help-heading">
                        <i class="fa fa-question-circle mr-2" aria-hidden="true"></i>
                        {{#str}}needhelp, local_jobboard{{/str}}
                    </h2>
                </div>
                <div class="card-body">
                    <p class="small text-muted mb-2">
                        {{#str}}applicationhelptext, local_jobboard{{/str}}
                    </p>
                    {{#helpcontactemail}}
                    <a href="mailto:{{helpcontactemail}}" class="btn btn-sm btn-outline-primary btn-block">
                        <i class="fa fa-envelope mr-1" aria-hidden="true"></i>
                        {{#str}}contactus, local_jobboard{{/str}}
                    </a>
                    {{/helpcontactemail}}
                </div>
            </section>
        </aside>
    </div>
</div>
{{! Styles moved to styles.css - Apply Page Styles section }}
