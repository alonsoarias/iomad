{{!
    @template local_jobboard/pages/dashboard

    Main dashboard page template.

    Context variables:
    * isadmin - Boolean if user is admin/manager
    * isreviewer - Boolean if user can review (not manager)
    * isapplicant - Boolean if user can apply (not manager/reviewer)
    * isvieweronly - Boolean if user can only view
    * welcome - Welcome section data {rolelabel, message}
    * showpubliclink - Boolean to show public page link
    * publicurl - URL to public page
    * applicationsurl - URL to applications page
    * stats - Array of stat cards for admin section
    * applicantstats - Array of stat cards for applicant section
    * adminsections - Array of admin section cards
    * workflowsections - Array of workflow cards for admin
    * reportsections - Array of report cards for admin
    * configsections - Array of config cards for admin
    * applicantsections - Array of applicant section cards
    * reviewersection - Reviewer section data
    * alerts - Array of alert messages

    Example context (json):
    {
        "isadmin": true,
        "welcome": {"rolelabel": "Administrator", "message": "Welcome to the dashboard"},
        "stats": [{"value": "5", "label": "Active Calls", "icon": "folder-open", "color": "primary"}]
    }
}}
<div class="local-jobboard-dashboard" data-region="jobboard-dashboard">
    {{! Welcome Header }}
    <div class="jb-welcome-section jb-bg-gradient-primary jb-text-white jb-rounded-lg jb-p-4 jb-mb-4">
        <div class="jb-d-flex jb-justify-content-between jb-align-items-center">
            <div>
                <h2 class="jb-mb-1 jb-fw-bold">{{#str}}dashboard, local_jobboard{{/str}}</h2>
                {{#welcome.rolelabel}}
                <span class="jb-badge jb-badge-light jb-mr-2">{{welcome.rolelabel}}</span>
                {{/welcome.rolelabel}}
                {{#welcome.message}}
                <p class="jb-mb-0 jb-opacity-75 jb-mt-2">{{welcome.message}}</p>
                {{/welcome.message}}
            </div>
            <i class="fa fa-briefcase fa-3x jb-opacity-25" aria-hidden="true"></i>
        </div>
        {{#showpubliclink}}
        <div class="jb-mt-3 jb-pt-3 jb-border-top jb-border-light">
            <a href="{{publicurl}}" class="jb-btn jb-btn-light jb-btn-sm jb-mr-2">
                <i class="fa fa-globe jb-mr-2" aria-hidden="true"></i>
                {{#str}}viewpublicpage, local_jobboard{{/str}}
            </a>
            {{#isapplicant}}
            <a href="{{applicationsurl}}" class="jb-btn jb-btn-outline-light jb-btn-sm">
                <i class="fa fa-folder-open jb-mr-2" aria-hidden="true"></i>
                {{#str}}myapplications, local_jobboard{{/str}}
            </a>
            {{/isapplicant}}
        </div>
        {{/showpubliclink}}
    </div>

    {{! Alerts }}
    {{#alerts.0}}
    <div class="jb-mb-4" role="region" aria-label="{{#str}}notifications, local_jobboard{{/str}}">
        {{#alerts}}
        <div class="jb-alert jb-alert-{{type}}" role="alert">
            {{#icon}}
            <i class="fa fa-{{icon}} jb-mr-2" aria-hidden="true"></i>
            {{/icon}}
            {{{message}}}
        </div>
        {{/alerts}}
    </div>
    {{/alerts.0}}

    {{! Admin/Manager Section }}
    {{#isadmin}}
    <section class="jb-admin-section jb-mb-5" aria-labelledby="admin-section-heading">
        <h2 class="jb-fs-5 jb-text-muted jb-mb-3" id="admin-section-heading">
            <i class="fa fa-cog jb-mr-2" aria-hidden="true"></i>
            {{#str}}administracion, local_jobboard{{/str}}
        </h2>

        {{! Statistics Row }}
        {{#stats.0}}
        <div class="jb-row jb-mb-4" role="region" aria-label="{{#str}}adminstatistics, local_jobboard{{/str}}">
            {{#stats}}
            <div class="jb-col-lg-3 jb-col-md-6 jb-mb-3">
                {{> local_jobboard/components/stat_card }}
            </div>
            {{/stats}}
        </div>
        {{/stats.0}}

        {{! Admin Action Cards }}
        <div class="jb-row">
            {{#adminsections}}
            <div class="jb-col-lg-4 jb-col-md-6 jb-mb-4">
                <article class="jb-card jb-card-h100 jb-card-shadow jb-section-card" aria-labelledby="admin-section-{{id}}">
                    <div class="jb-card-header jb-card-header-{{color}}">
                        <h3 class="jb-fs-6 jb-mb-0" id="admin-section-{{id}}">
                            <i class="fa fa-{{icon}} jb-mr-2" aria-hidden="true"></i>
                            {{title}}
                        </h3>
                    </div>
                    <div class="jb-card-body">
                        <p class="jb-text-muted">{{description}}</p>
                        {{#features.0}}
                        <ul class="jb-list-unstyled jb-small jb-text-muted jb-mb-3" aria-label="{{#str}}features, local_jobboard{{/str}}">
                            {{#features}}
                            <li class="jb-mb-1">
                                <i class="fa fa-check jb-text-{{../color}} jb-mr-1" aria-hidden="true"></i>
                                {{.}}
                            </li>
                            {{/features}}
                        </ul>
                        {{/features.0}}
                    </div>
                    <div class="jb-card-footer jb-bg-white jb-border-top-0">
                        <a href="{{url}}" class="jb-btn jb-btn-{{color}} jb-btn-block" aria-label="{{buttonlabel}}: {{title}}">
                            {{buttonlabel}}
                            <i class="fa fa-arrow-right jb-ml-1" aria-hidden="true"></i>
                        </a>
                    </div>
                </article>
            </div>
            {{/adminsections}}
        </div>

        {{! Workflow Management Section }}
        {{#workflowsections.0}}
        <h3 class="jb-fs-5 jb-text-muted jb-mb-3 jb-mt-4">
            <i class="fa fa-sitemap jb-mr-2" aria-hidden="true"></i>
            {{#str}}workflowmanagement, local_jobboard{{/str}}
        </h3>
        <div class="jb-row jb-mb-4">
            {{#workflowsections}}
            <div class="jb-col-md-4 jb-col-sm-6 jb-mb-3">
                <div class="jb-card jb-border-0 jb-bg-light jb-card-h100">
                    <div class="jb-card-body jb-d-flex jb-align-items-center">
                        <i class="fa fa-{{icon}} fa-2x jb-text-{{color}} jb-mr-3" aria-hidden="true"></i>
                        <div>
                            <h4 class="jb-fs-6 jb-mb-1">{{title}}</h4>
                            <small class="jb-d-block jb-text-muted jb-mb-2">{{description}}</small>
                            <a href="{{url}}" class="jb-btn jb-btn-sm jb-btn-outline-{{color}}">
                                <i class="fa fa-{{buttonicon}} jb-mr-1" aria-hidden="true"></i>
                                {{buttonlabel}}
                            </a>
                        </div>
                    </div>
                </div>
            </div>
            {{/workflowsections}}
        </div>
        {{/workflowsections.0}}

        {{! Reports & Data Section }}
        {{#reportsections.0}}
        <h3 class="jb-fs-5 jb-text-muted jb-mb-3">
            <i class="fa fa-chart-bar jb-mr-2" aria-hidden="true"></i>
            {{#str}}reportsanddata, local_jobboard{{/str}}
        </h3>
        <div class="jb-row jb-mb-4">
            {{#reportsections}}
            <div class="jb-col-md-4 jb-col-sm-6 jb-mb-3">
                <div class="jb-card jb-border-0 jb-bg-light jb-card-h100">
                    <div class="jb-card-body jb-d-flex jb-align-items-center">
                        <i class="fa fa-{{icon}} fa-2x jb-text-{{color}} jb-mr-3" aria-hidden="true"></i>
                        <div>
                            <h4 class="jb-fs-6 jb-mb-1">{{title}}</h4>
                            <small class="jb-d-block jb-text-muted jb-mb-2">{{description}}</small>
                            <a href="{{url}}" class="jb-btn jb-btn-sm jb-btn-outline-{{color}}">
                                <i class="fa fa-{{buttonicon}} jb-mr-1" aria-hidden="true"></i>
                                {{buttonlabel}}
                            </a>
                        </div>
                    </div>
                </div>
            </div>
            {{/reportsections}}
        </div>
        {{/reportsections.0}}

        {{! System Configuration Section (Admin only) }}
        {{#configsections.0}}
        <h3 class="jb-fs-5 jb-text-muted jb-mb-3">
            <i class="fa fa-cogs jb-mr-2" aria-hidden="true"></i>
            {{#str}}systemconfiguration, local_jobboard{{/str}}
        </h3>
        <div class="jb-row jb-mb-4">
            {{#configsections}}
            <div class="jb-col-md-3 jb-col-sm-6 jb-mb-3">
                <div class="jb-card jb-border-0 jb-bg-light jb-card-h100">
                    <div class="jb-card-body jb-d-flex jb-align-items-center">
                        <i class="fa fa-{{icon}} fa-2x jb-text-{{color}} jb-mr-3" aria-hidden="true"></i>
                        <div>
                            <h4 class="jb-fs-6 jb-mb-1">{{title}}</h4>
                            <small class="jb-d-block jb-text-muted jb-mb-2">{{description}}</small>
                            <a href="{{url}}" class="jb-btn jb-btn-sm jb-btn-outline-{{color}}">
                                <i class="fa fa-{{buttonicon}} jb-mr-1" aria-hidden="true"></i>
                                {{buttonlabel}}
                            </a>
                        </div>
                    </div>
                </div>
            </div>
            {{/configsections}}
        </div>
        {{/configsections.0}}
    </section>
    {{/isadmin}}

    {{! Reviewer Section }}
    {{#isreviewer}}
    <section class="jb-reviewer-section jb-mb-5" aria-labelledby="reviewer-section-heading">
        <h2 class="jb-fs-5 jb-text-muted jb-mb-3" id="reviewer-section-heading">
            <i class="fa fa-clipboard-check jb-mr-2" aria-hidden="true"></i>
            {{#str}}reviewertasks, local_jobboard{{/str}}
        </h2>

        <div class="jb-row">
            <div class="jb-col-lg-8">
                <article class="jb-card jb-card-shadow jb-card-h100" aria-labelledby="reviews-card-heading">
                    <div class="jb-card-header jb-card-header-info jb-d-flex jb-justify-content-between jb-align-items-center">
                        <h3 class="jb-fs-6 jb-mb-0" id="reviews-card-heading">
                            <i class="fa fa-tasks jb-mr-2" aria-hidden="true"></i>
                            {{#str}}myreviews, local_jobboard{{/str}}
                        </h3>
                        {{#reviewersection.pendingcount}}
                        <span class="jb-badge jb-badge-warning" aria-label="{{reviewersection.pendingcount}} {{#str}}pending, local_jobboard{{/str}}">
                            {{reviewersection.pendingcount}} {{#str}}pending, local_jobboard{{/str}}
                        </span>
                        {{/reviewersection.pendingcount}}
                    </div>
                    <div class="jb-card-body">
                        <p class="jb-text-muted">{{#str}}myreviews_desc, local_jobboard{{/str}}</p>
                        {{#reviewersection.haspendingreview}}
                        <div class="jb-alert jb-alert-warning" role="alert">
                            <i class="fa fa-exclamation-triangle jb-mr-1" aria-hidden="true"></i>
                            {{#str}}pending_reviews_alert, local_jobboard, {{reviewersection.pendingcount}}{{/str}}
                        </div>
                        {{/reviewersection.haspendingreview}}
                    </div>
                    <div class="jb-card-footer jb-bg-white">
                        <a href="{{reviewersection.url}}" class="jb-btn jb-btn-info">
                            {{#str}}viewmyreviews, local_jobboard{{/str}}
                            <i class="fa fa-arrow-right jb-ml-1" aria-hidden="true"></i>
                        </a>
                    </div>
                </article>
            </div>
            <div class="jb-col-lg-4">
                <div class="jb-card jb-card-shadow jb-card-h100 jb-bg-light" role="status" aria-label="{{#str}}completedreviews, local_jobboard{{/str}}">
                    <div class="jb-card-body jb-text-center">
                        <i class="fa fa-chart-pie fa-3x jb-text-info jb-mb-3" aria-hidden="true"></i>
                        <p class="jb-fs-3 jb-mb-1" aria-label="{{reviewersection.completedcount}} {{#str}}completedreviews, local_jobboard{{/str}}">
                            {{reviewersection.completedcount}}
                        </p>
                        <p class="jb-text-muted jb-mb-0">{{#str}}completedreviews, local_jobboard{{/str}}</p>
                    </div>
                </div>
            </div>
        </div>
    </section>
    {{/isreviewer}}

    {{! Applicant Section }}
    {{#isapplicant}}
    <section class="jb-applicant-section" aria-labelledby="applicant-section-heading">
        <h2 class="jb-fs-5 jb-text-muted jb-mb-3" id="applicant-section-heading">
            <i class="fa fa-user jb-mr-2" aria-hidden="true"></i>
            {{#str}}myapplications, local_jobboard{{/str}}
        </h2>

        {{! Applicant Statistics }}
        {{#applicantstats.0}}
        <div class="jb-row jb-mb-4" role="region" aria-label="{{#str}}applicantstatistics, local_jobboard{{/str}}">
            {{#applicantstats}}
            <div class="jb-col-lg-3 jb-col-md-6 jb-mb-3">
                {{> local_jobboard/components/stat_card }}
            </div>
            {{/applicantstats}}
        </div>
        {{/applicantstats.0}}

        {{! Applicant Action Cards }}
        <div class="jb-row">
            {{#applicantsections}}
            <div class="jb-col-lg-6 jb-mb-4">
                <article class="jb-card jb-card-h100 jb-card-shadow jb-section-card" aria-labelledby="applicant-section-{{id}}">
                    <div class="jb-card-header jb-card-header-{{color}}">
                        <h3 class="jb-fs-6 jb-mb-0" id="applicant-section-{{id}}">
                            <i class="fa fa-{{icon}} jb-mr-2" aria-hidden="true"></i>
                            {{title}}
                        </h3>
                    </div>
                    <div class="jb-card-body">
                        <p class="jb-text-muted">{{description}}</p>
                        {{#alert}}
                        <div class="jb-alert jb-alert-{{alerttype}}" role="alert">
                            <i class="fa fa-info-circle jb-mr-1" aria-hidden="true"></i>
                            {{alert}}
                        </div>
                        {{/alert}}
                    </div>
                    <div class="jb-card-footer jb-bg-white jb-border-top-0">
                        <a href="{{url}}" class="jb-btn jb-btn-{{color}}" aria-label="{{buttonlabel}}: {{title}}">
                            {{buttonlabel}}
                            <i class="fa fa-arrow-right jb-ml-1" aria-hidden="true"></i>
                        </a>
                    </div>
                </article>
            </div>
            {{/applicantsections}}
        </div>
    </section>
    {{/isapplicant}}

    {{! Viewer Only Section }}
    {{#isvieweronly}}
    <section class="jb-viewer-section">
        <div class="jb-card jb-card-shadow">
            <div class="jb-card-body jb-text-center jb-py-5">
                <i class="fa fa-briefcase fa-4x jb-text-muted jb-mb-4" aria-hidden="true"></i>
                <h3 class="jb-mb-3">{{#str}}welcometojobboard, local_jobboard{{/str}}</h3>
                <p class="jb-text-muted jb-mb-4">{{#str}}vieweronly_desc, local_jobboard{{/str}}</p>
                {{#showpubliclink}}
                <a href="{{publicurl}}" class="jb-btn jb-btn-primary jb-btn-lg">
                    <i class="fa fa-globe jb-mr-2" aria-hidden="true"></i>
                    {{#str}}viewpublicvacancies, local_jobboard{{/str}}
                </a>
                {{/showpubliclink}}
            </div>
        </div>
    </section>
    {{/isvieweronly}}
</div>

{{#js}}
require(['local_jobboard/dashboard'], function(dashboard) {
    dashboard.init();
});
{{/js}}
