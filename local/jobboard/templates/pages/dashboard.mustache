{{!
    @template local_jobboard/pages/dashboard

    Main dashboard page template.

    Context variables:
    * pageheader - Page header data for page_header partial
    * isadmin - Boolean if user is admin/manager
    * isreviewer - Boolean if user can review
    * isapplicant - Boolean if user can apply
    * stats - Array of stat cards for admin section
    * applicantstats - Array of stat cards for applicant section
    * adminsections - Array of admin section cards
    * applicantsections - Array of applicant section cards
    * reviewersection - Reviewer section data
    * alerts - Array of alert messages

    Example context (json):
    {
        "isadmin": true,
        "stats": [{"value": "5", "label": "Active Calls", "icon": "folder-open", "color": "primary"}]
    }
}}
<div class="local-jobboard-dashboard" data-region="jobboard-dashboard">
    {{! Page Header }}
    {{> local_jobboard/components/page_header }}

    {{! Alerts }}
    {{#alerts.0}}
    <div class="jb-mb-4" role="region" aria-label="{{#str}}notifications, local_jobboard{{/str}}">
        {{#alerts}}
        <div class="jb-alert jb-alert-{{type}}" role="alert">
            {{#icon}}
            <i class="fa fa-{{icon}} jb-mr-2" aria-hidden="true"></i>
            {{/icon}}
            {{{message}}}
        </div>
        {{/alerts}}
    </div>
    {{/alerts.0}}

    {{! Admin/Manager Section }}
    {{#isadmin}}
    <section class="jb-admin-section jb-mb-5" aria-labelledby="admin-section-heading">
        <h2 class="jb-fs-5 jb-text-muted jb-mb-3" id="admin-section-heading">
            <i class="fa fa-cog jb-mr-2" aria-hidden="true"></i>
            {{#str}}administracion, local_jobboard{{/str}}
        </h2>

        {{! Statistics Row }}
        {{#stats.0}}
        <div class="jb-row jb-mb-4" role="region" aria-label="{{#str}}adminstatistics, local_jobboard{{/str}}">
            {{#stats}}
            <div class="jb-col-lg-3 jb-col-md-6 jb-mb-3">
                {{> local_jobboard/components/stat_card }}
            </div>
            {{/stats}}
        </div>
        {{/stats.0}}

        {{! Admin Action Cards }}
        <div class="jb-row">
            {{#adminsections}}
            <div class="jb-col-lg-4 jb-col-md-6 jb-mb-4">
                <article class="jb-card jb-card-h100 jb-card-shadow jb-section-card" aria-labelledby="admin-section-{{id}}">
                    <div class="jb-card-header jb-card-header-{{color}}">
                        <h3 class="jb-fs-6 jb-mb-0" id="admin-section-{{id}}">
                            <i class="fa fa-{{icon}} jb-mr-2" aria-hidden="true"></i>
                            {{title}}
                        </h3>
                    </div>
                    <div class="jb-card-body">
                        <p class="jb-text-muted">{{description}}</p>
                        {{#features.0}}
                        <ul class="jb-list-unstyled jb-small jb-text-muted jb-mb-3" aria-label="{{#str}}features, local_jobboard{{/str}}">
                            {{#features}}
                            <li class="jb-mb-1">
                                <i class="fa fa-check jb-text-{{../color}} jb-mr-1" aria-hidden="true"></i>
                                {{.}}
                            </li>
                            {{/features}}
                        </ul>
                        {{/features.0}}
                    </div>
                    <div class="jb-card-footer jb-bg-white jb-border-top-0">
                        <a href="{{url}}" class="jb-btn jb-btn-{{color}} jb-btn-block" aria-label="{{buttonlabel}}: {{title}}">
                            {{buttonlabel}}
                            <i class="fa fa-arrow-right jb-ml-1" aria-hidden="true"></i>
                        </a>
                    </div>
                </article>
            </div>
            {{/adminsections}}
        </div>
    </section>
    {{/isadmin}}

    {{! Reviewer Section }}
    {{#isreviewer}}
    <section class="jb-reviewer-section jb-mb-5" aria-labelledby="reviewer-section-heading">
        <h2 class="jb-fs-5 jb-text-muted jb-mb-3" id="reviewer-section-heading">
            <i class="fa fa-clipboard-check jb-mr-2" aria-hidden="true"></i>
            {{#str}}reviewertasks, local_jobboard{{/str}}
        </h2>

        <div class="jb-row">
            <div class="jb-col-lg-8">
                <article class="jb-card jb-card-shadow jb-card-h100" aria-labelledby="reviews-card-heading">
                    <div class="jb-card-header jb-card-header-info jb-d-flex jb-justify-content-between jb-align-items-center">
                        <h3 class="jb-fs-6 jb-mb-0" id="reviews-card-heading">
                            <i class="fa fa-tasks jb-mr-2" aria-hidden="true"></i>
                            {{#str}}myreviews, local_jobboard{{/str}}
                        </h3>
                        {{#reviewersection.pendingcount}}
                        <span class="jb-badge jb-badge-warning" aria-label="{{reviewersection.pendingcount}} {{#str}}pending, local_jobboard{{/str}}">
                            {{reviewersection.pendingcount}} {{#str}}pending, local_jobboard{{/str}}
                        </span>
                        {{/reviewersection.pendingcount}}
                    </div>
                    <div class="jb-card-body">
                        <p class="jb-text-muted">{{#str}}myreviews_desc, local_jobboard{{/str}}</p>
                        {{#reviewersection.haspendingreview}}
                        <div class="jb-alert jb-alert-warning" role="alert">
                            <i class="fa fa-exclamation-triangle jb-mr-1" aria-hidden="true"></i>
                            {{#str}}pending_reviews_alert, local_jobboard, {{reviewersection.pendingcount}}{{/str}}
                        </div>
                        {{/reviewersection.haspendingreview}}
                    </div>
                    <div class="jb-card-footer jb-bg-white">
                        <a href="{{reviewersection.url}}" class="jb-btn jb-btn-info">
                            {{#str}}viewmyreviews, local_jobboard{{/str}}
                            <i class="fa fa-arrow-right jb-ml-1" aria-hidden="true"></i>
                        </a>
                    </div>
                </article>
            </div>
            <div class="jb-col-lg-4">
                <div class="jb-card jb-card-shadow jb-card-h100 jb-bg-light" role="status" aria-label="{{#str}}completedreviews, local_jobboard{{/str}}">
                    <div class="jb-card-body jb-text-center">
                        <i class="fa fa-chart-pie fa-3x jb-text-info jb-mb-3" aria-hidden="true"></i>
                        <p class="jb-fs-3 jb-mb-1" aria-label="{{reviewersection.completedcount}} {{#str}}completedreviews, local_jobboard{{/str}}">
                            {{reviewersection.completedcount}}
                        </p>
                        <p class="jb-text-muted jb-mb-0">{{#str}}completedreviews, local_jobboard{{/str}}</p>
                    </div>
                </div>
            </div>
        </div>
    </section>
    {{/isreviewer}}

    {{! Applicant Section }}
    {{#isapplicant}}
    <section class="jb-applicant-section" aria-labelledby="applicant-section-heading">
        <h2 class="jb-fs-5 jb-text-muted jb-mb-3" id="applicant-section-heading">
            <i class="fa fa-user jb-mr-2" aria-hidden="true"></i>
            {{#str}}myapplications, local_jobboard{{/str}}
        </h2>

        {{! Applicant Statistics }}
        {{#applicantstats.0}}
        <div class="jb-row jb-mb-4" role="region" aria-label="{{#str}}applicantstatistics, local_jobboard{{/str}}">
            {{#applicantstats}}
            <div class="jb-col-lg-3 jb-col-md-6 jb-mb-3">
                {{> local_jobboard/components/stat_card }}
            </div>
            {{/applicantstats}}
        </div>
        {{/applicantstats.0}}

        {{! Applicant Action Cards }}
        <div class="jb-row">
            {{#applicantsections}}
            <div class="jb-col-lg-6 jb-mb-4">
                <article class="jb-card jb-card-h100 jb-card-shadow jb-section-card" aria-labelledby="applicant-section-{{id}}">
                    <div class="jb-card-header jb-card-header-{{color}}">
                        <h3 class="jb-fs-6 jb-mb-0" id="applicant-section-{{id}}">
                            <i class="fa fa-{{icon}} jb-mr-2" aria-hidden="true"></i>
                            {{title}}
                        </h3>
                    </div>
                    <div class="jb-card-body">
                        <p class="jb-text-muted">{{description}}</p>
                        {{#alert}}
                        <div class="jb-alert jb-alert-{{alerttype}}" role="alert">
                            <i class="fa fa-info-circle jb-mr-1" aria-hidden="true"></i>
                            {{alert}}
                        </div>
                        {{/alert}}
                    </div>
                    <div class="jb-card-footer jb-bg-white jb-border-top-0">
                        <a href="{{url}}" class="jb-btn jb-btn-{{color}}" aria-label="{{buttonlabel}}: {{title}}">
                            {{buttonlabel}}
                            <i class="fa fa-arrow-right jb-ml-1" aria-hidden="true"></i>
                        </a>
                    </div>
                </article>
            </div>
            {{/applicantsections}}
        </div>
    </section>
    {{/isapplicant}}
</div>

{{#js}}
require(['local_jobboard/dashboard'], function(dashboard) {
    dashboard.init();
});
{{/js}}
