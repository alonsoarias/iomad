define(["jquery","core/ajax","core/notification","core/str"],function($,Ajax,Notification,Str){var init=function(){var companySelect=$("#id_companyid");var departmentSelect=$("#id_departmentid");if(!companySelect.length||!departmentSelect.length){return}var currentDepartmentId=departmentSelect.val();companySelect.on("change",function(){var companyId=$(this).val();departmentSelect.prop("disabled",true);if(!companyId||companyId=="0"){Str.get_string("selectdepartment","local_jobboard").then(function(str){departmentSelect.empty().append($("<option>",{value:0,text:str}));departmentSelect.prop("disabled",false)}).catch(Notification.exception);return}Ajax.call([{methodname:"local_jobboard_get_departments",args:{companyid:parseInt(companyId,10)}}])[0].then(function(departments){return Str.get_string("selectdepartment","local_jobboard").then(function(str){departmentSelect.empty();departmentSelect.append($("<option>",{value:0,text:str}));if(departments&&departments.length>0){departments.forEach(function(dept){departmentSelect.append($("<option>",{value:dept.id,text:dept.name}))})}departmentSelect.prop("disabled",false)})}).catch(function(error){Notification.exception(error);departmentSelect.prop("disabled",false)})})};return{init:init}});