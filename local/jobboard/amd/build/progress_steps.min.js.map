{"version":3,"file":"progress_steps.min.js","sources":["../src/progress_steps.js"],"sourcesContent":["// This file is part of Moodle - http://moodle.org/\n//\n// Moodle is free software: you can redistribute it and/or modify\n// it under the terms of the GNU General Public License as published by\n// the Free Software Foundation, either version 3 of the License, or\n// (at your option) any later version.\n//\n// Moodle is distributed in the hope that it will be useful,\n// but WITHOUT ANY WARRANTY; without even the implied warranty of\n// MERCHANTABILITY or FITNESS FOR A PARTICULAR PURPOSE.  See the\n// GNU General Public License for more details.\n//\n// You should have received a copy of the GNU General Public License\n// along with Moodle.  If not, see <http://www.gnu.org/licenses/>.\n\n/**\n * Progress steps indicator module for multi-step forms.\n *\n * @module     local_jobboard/progress_steps\n * @copyright  2024 ISER\n * @license    http://www.gnu.org/copyleft/gpl.html GNU GPL v3 or later\n */\ndefine(['jquery'], function($) {\n    'use strict';\n\n    /**\n     * Progress steps class.\n     *\n     * @param {Object} config Configuration options\n     * @param {string} config.containerId Container element ID\n     * @param {Array} config.steps Array of step definitions\n     * @param {Object} config.sectionMap Map of form section IDs to step indices\n     */\n    var ProgressSteps = function(config) {\n        this.config = $.extend({\n            containerId: 'jb-progress-container',\n            steps: [],\n            sectionMap: {},\n            currentStep: 0\n        }, config);\n\n        this.$container = $('#' + this.config.containerId);\n        this.init();\n    };\n\n    /**\n     * Initialize the progress steps.\n     */\n    ProgressSteps.prototype.init = function() {\n        if (!this.$container.length) {\n            return;\n        }\n\n        this.renderSteps();\n        this.bindEvents();\n        this.updateStep(this.config.currentStep);\n    };\n\n    /**\n     * Render the progress steps HTML.\n     */\n    ProgressSteps.prototype.renderSteps = function() {\n        var html = '<div class=\"jb-progress-container\">';\n        html += '<ul class=\"jb-progress-steps\" role=\"progressbar\" aria-label=\"' +\n                M.util.get_string('signup_progress', 'local_jobboard') + '\">';\n\n        this.config.steps.forEach(function(step, index) {\n            var stepClass = 'jb-step';\n            var ariaLabel = step.label;\n\n            if (index < this.config.currentStep) {\n                stepClass += ' completed';\n                ariaLabel += ' - ' + M.util.get_string('completedstep', 'local_jobboard');\n            } else if (index === this.config.currentStep) {\n                stepClass += ' active';\n                ariaLabel += ' - ' + M.util.get_string('currentstep', 'local_jobboard');\n            } else {\n                ariaLabel += ' - ' + M.util.get_string('pendingstep', 'local_jobboard');\n            }\n\n            html += '<li class=\"' + stepClass + '\" data-step=\"' + index + '\" aria-label=\"' + ariaLabel + '\">';\n            html += '<div class=\"jb-step-icon\"><i class=\"fa fa-' + step.icon + '\"></i></div>';\n            html += '<span class=\"jb-step-label\">' + step.label + '</span>';\n            html += '</li>';\n        }.bind(this));\n\n        html += '</ul></div>';\n\n        this.$container.html(html);\n    };\n\n    /**\n     * Bind event handlers.\n     */\n    ProgressSteps.prototype.bindEvents = function() {\n        var self = this;\n\n        // Listen for form section expansions\n        Object.keys(this.config.sectionMap).forEach(function(sectionId) {\n            var $section = $('#id_' + sectionId);\n            if ($section.length) {\n                $section.on('click', function() {\n                    var stepIndex = self.config.sectionMap[sectionId];\n                    self.updateStep(stepIndex);\n                });\n            }\n        });\n\n        // Listen for field changes to mark sections as complete\n        $('form.mform').on('change', 'input, select, textarea', function() {\n            self.checkSectionCompletion();\n        });\n    };\n\n    /**\n     * Update the current step.\n     *\n     * @param {number} stepIndex Step index to set as current\n     */\n    ProgressSteps.prototype.updateStep = function(stepIndex) {\n        this.config.currentStep = stepIndex;\n\n        this.$container.find('.jb-step').each(function(index) {\n            var $step = $(this);\n            $step.removeClass('active completed');\n\n            if (index < stepIndex) {\n                $step.addClass('completed');\n            } else if (index === stepIndex) {\n                $step.addClass('active');\n            }\n        });\n    };\n\n    /**\n     * Mark a step as completed.\n     *\n     * @param {number} stepIndex Step index to mark as completed\n     */\n    ProgressSteps.prototype.markCompleted = function(stepIndex) {\n        var $step = this.$container.find('.jb-step').eq(stepIndex);\n        $step.addClass('completed');\n    };\n\n    /**\n     * Check section completion based on required fields.\n     */\n    ProgressSteps.prototype.checkSectionCompletion = function() {\n        var self = this;\n\n        Object.keys(this.config.sectionMap).forEach(function(sectionId) {\n            var $section = $('#id_' + sectionId);\n            if (!$section.length) {\n                return;\n            }\n\n            var $fieldset = $section.closest('fieldset');\n            var $requiredFields = $fieldset.find('[required], .required input, .required select, .required textarea');\n            var allFilled = true;\n\n            $requiredFields.each(function() {\n                if (!$(this).val()) {\n                    allFilled = false;\n                    return false;\n                }\n            });\n\n            if (allFilled && $requiredFields.length > 0) {\n                var stepIndex = self.config.sectionMap[sectionId];\n                self.markCompleted(stepIndex);\n            }\n        });\n    };\n\n    return {\n        /**\n         * Initialize progress steps.\n         *\n         * @param {Object} config Configuration object\n         * @return {ProgressSteps} Progress steps instance\n         */\n        init: function(config) {\n            return new ProgressSteps(config);\n        }\n    };\n});\n"],"names":["define","$","ProgressSteps","config","extend","containerId","steps","sectionMap","currentStep","$container","this","init","prototype","length","renderSteps","bindEvents","updateStep","html","M","util","get_string","forEach","step","index","stepClass","ariaLabel","label","icon","bind","self","Object","keys","sectionId","$section","on","stepIndex","checkSectionCompletion","find","each","$step","removeClass","addClass","markCompleted","eq","$requiredFields","closest","allFilled","val"],"mappings":";;;;;;;AAsBAA,uCAAO,CAAC,WAAW,SAASC,OAWpBC,cAAgB,SAASC,aACpBA,OAASF,EAAEG,OAAO,CACnBC,YAAa,wBACbC,MAAO,GACPC,WAAY,GACZC,YAAa,GACdL,aAEEM,WAAaR,EAAE,IAAMS,KAAKP,OAAOE,kBACjCM,eAMTT,cAAcU,UAAUD,KAAO,WACtBD,KAAKD,WAAWI,cAIhBC,mBACAC,kBACAC,WAAWN,KAAKP,OAAOK,eAMhCN,cAAcU,UAAUE,YAAc,eAC9BG,KAAO,sCACXA,MAAQ,gEACAC,EAAEC,KAAKC,WAAW,kBAAmB,kBAAoB,UAE5DjB,OAAOG,MAAMe,QAAQ,SAASC,KAAMC,WACjCC,UAAY,UACZC,UAAYH,KAAKI,MAEjBH,MAAQb,KAAKP,OAAOK,aACpBgB,WAAa,aACbC,WAAa,MAAQP,EAAEC,KAAKC,WAAW,gBAAiB,mBACjDG,QAAUb,KAAKP,OAAOK,aAC7BgB,WAAa,UACbC,WAAa,MAAQP,EAAEC,KAAKC,WAAW,cAAe,mBAEtDK,WAAa,MAAQP,EAAEC,KAAKC,WAAW,cAAe,kBAG1DH,MAAQ,cAAgBO,UAAY,gBAAkBD,MAAQ,iBAAmBE,UAAY,KAC7FR,MAAQ,6CAA+CK,KAAKK,KAAO,eACnEV,MAAQ,+BAAiCK,KAAKI,MAAQ,UACtDT,MAAQ,SACVW,KAAKlB,OAEPO,MAAQ,mBAEHR,WAAWQ,KAAKA,OAMzBf,cAAcU,UAAUG,WAAa,eAC7Bc,KAAOnB,KAGXoB,OAAOC,KAAKrB,KAAKP,OAAOI,YAAYc,SAAQ,SAASW,eAC7CC,SAAWhC,EAAE,OAAS+B,WACtBC,SAASpB,QACToB,SAASC,GAAG,SAAS,eACbC,UAAYN,KAAK1B,OAAOI,WAAWyB,WACvCH,KAAKb,WAAWmB,iBAM5BlC,EAAE,cAAciC,GAAG,SAAU,2BAA2B,WACpDL,KAAKO,6BASblC,cAAcU,UAAUI,WAAa,SAASmB,gBACrChC,OAAOK,YAAc2B,eAErB1B,WAAW4B,KAAK,YAAYC,MAAK,SAASf,WACvCgB,MAAQtC,EAAES,MACd6B,MAAMC,YAAY,oBAEdjB,MAAQY,UACRI,MAAME,SAAS,aACRlB,QAAUY,WACjBI,MAAME,SAAS,cAU3BvC,cAAcU,UAAU8B,cAAgB,SAASP,WACjCzB,KAAKD,WAAW4B,KAAK,YAAYM,GAAGR,WAC1CM,SAAS,cAMnBvC,cAAcU,UAAUwB,uBAAyB,eACzCP,KAAOnB,KAEXoB,OAAOC,KAAKrB,KAAKP,OAAOI,YAAYc,SAAQ,SAASW,eAC7CC,SAAWhC,EAAE,OAAS+B,cACrBC,SAASpB,YAKV+B,gBADYX,SAASY,QAAQ,YACDR,KAAK,qEACjCS,WAAY,KAEhBF,gBAAgBN,MAAK,eACZrC,EAAES,MAAMqC,aACTD,WAAY,GACL,KAIXA,WAAaF,gBAAgB/B,OAAS,EAAG,KACrCsB,UAAYN,KAAK1B,OAAOI,WAAWyB,WACvCH,KAAKa,cAAcP,iBAKxB,CAOHxB,KAAM,SAASR,eACJ,IAAID,cAAcC"}