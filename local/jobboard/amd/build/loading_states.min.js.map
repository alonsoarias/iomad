{"version":3,"file":"loading_states.min.js","sources":["../src/loading_states.js"],"sourcesContent":["// This file is part of Moodle - http://moodle.org/\n//\n// Moodle is free software: you can redistribute it and/or modify\n// it under the terms of the GNU General Public License as published by\n// the Free Software Foundation, either version 3 of the License, or\n// (at your option) any later version.\n//\n// Moodle is distributed in the hope that it will be useful,\n// but WITHOUT ANY WARRANTY; without even the implied warranty of\n// MERCHANTABILITY or FITNESS FOR A PARTICULAR PURPOSE.  See the\n// GNU General Public License for more details.\n//\n// You should have received a copy of the GNU General Public License\n// along with Moodle.  If not, see <http://www.gnu.org/licenses/>.\n\n/**\n * Loading states module for visual feedback during async operations.\n *\n * @module     local_jobboard/loading_states\n * @copyright  2024 ISER\n * @license    http://www.gnu.org/copyleft/gpl.html GNU GPL v3 or later\n */\ndefine(['jquery'], function($) {\n    'use strict';\n\n    var LoadingStates = {\n        /**\n         * Add loading state to a button.\n         *\n         * @param {jQuery|string} button Button element or selector\n         * @param {string} loadingText Optional loading text\n         */\n        buttonLoading: function(button, loadingText) {\n            var $btn = $(button);\n            if (!$btn.length) {\n                return;\n            }\n\n            // Store original state\n            $btn.data('original-text', $btn.val() || $btn.text());\n            $btn.data('original-html', $btn.html());\n            $btn.data('was-disabled', $btn.prop('disabled'));\n\n            // Apply loading state\n            $btn.addClass('is-loading');\n            $btn.prop('disabled', true);\n\n            if (loadingText) {\n                if ($btn.is('input')) {\n                    $btn.val(loadingText);\n                } else {\n                    $btn.html('<i class=\"fa fa-spinner fa-spin mr-2\"></i>' + loadingText);\n                }\n            }\n        },\n\n        /**\n         * Remove loading state from a button.\n         *\n         * @param {jQuery|string} button Button element or selector\n         */\n        buttonReset: function(button) {\n            var $btn = $(button);\n            if (!$btn.length) {\n                return;\n            }\n\n            $btn.removeClass('is-loading');\n\n            // Restore original state\n            if ($btn.is('input')) {\n                $btn.val($btn.data('original-text'));\n            } else {\n                $btn.html($btn.data('original-html'));\n            }\n\n            if (!$btn.data('was-disabled')) {\n                $btn.prop('disabled', false);\n            }\n        },\n\n        /**\n         * Add loading overlay to a container.\n         *\n         * @param {jQuery|string} container Container element or selector\n         */\n        containerLoading: function(container) {\n            var $container = $(container);\n            if (!$container.length) {\n                return;\n            }\n\n            $container.addClass('jb-loading-overlay is-loading');\n        },\n\n        /**\n         * Remove loading overlay from a container.\n         *\n         * @param {jQuery|string} container Container element or selector\n         */\n        containerReset: function(container) {\n            var $container = $(container);\n            if (!$container.length) {\n                return;\n            }\n\n            $container.removeClass('jb-loading-overlay is-loading');\n        },\n\n        /**\n         * Show skeleton loading placeholders.\n         *\n         * @param {jQuery|string} container Container element or selector\n         * @param {Object} options Skeleton options\n         * @param {number} options.cards Number of skeleton cards to show\n         * @param {string} options.type Type of skeleton (card, list, text)\n         */\n        showSkeleton: function(container, options) {\n            var $container = $(container);\n            if (!$container.length) {\n                return;\n            }\n\n            options = $.extend({\n                cards: 3,\n                type: 'card'\n            }, options);\n\n            var html = '';\n\n            if (options.type === 'card') {\n                for (var i = 0; i < options.cards; i++) {\n                    html += '<div class=\"col-md-4 mb-4\">';\n                    html += '<div class=\"card\">';\n                    html += '<div class=\"card-body\">';\n                    html += '<div class=\"jb-skeleton jb-skeleton-title\"></div>';\n                    html += '<div class=\"jb-skeleton jb-skeleton-text\"></div>';\n                    html += '<div class=\"jb-skeleton jb-skeleton-text short\"></div>';\n                    html += '</div></div></div>';\n                }\n            } else if (options.type === 'list') {\n                html += '<div class=\"list-group\">';\n                for (var j = 0; j < options.cards; j++) {\n                    html += '<div class=\"list-group-item\">';\n                    html += '<div class=\"d-flex align-items-center\">';\n                    html += '<div class=\"jb-skeleton jb-skeleton-avatar mr-3\"></div>';\n                    html += '<div class=\"flex-grow-1\">';\n                    html += '<div class=\"jb-skeleton jb-skeleton-text\" style=\"width: 60%\"></div>';\n                    html += '<div class=\"jb-skeleton jb-skeleton-text short\"></div>';\n                    html += '</div></div></div>';\n                }\n                html += '</div>';\n            } else if (options.type === 'text') {\n                for (var k = 0; k < options.cards; k++) {\n                    html += '<div class=\"jb-skeleton jb-skeleton-text mb-2\"></div>';\n                }\n            }\n\n            $container.data('original-content', $container.html());\n            $container.html(html);\n        },\n\n        /**\n         * Remove skeleton loading and restore content.\n         *\n         * @param {jQuery|string} container Container element or selector\n         * @param {string} newContent Optional new content to display\n         */\n        hideSkeleton: function(container, newContent) {\n            var $container = $(container);\n            if (!$container.length) {\n                return;\n            }\n\n            if (newContent !== undefined) {\n                $container.html(newContent);\n            } else if ($container.data('original-content')) {\n                $container.html($container.data('original-content'));\n            }\n        },\n\n        /**\n         * Auto-initialize loading states for forms.\n         */\n        initFormHandlers: function() {\n            var self = this;\n\n            // Handle form submissions\n            $(document).on('submit', 'form.mform', function() {\n                var $form = $(this);\n                var $submitBtn = $form.find('input[type=\"submit\"][name=\"submitbutton\"]');\n\n                if ($submitBtn.length && !$submitBtn.hasClass('is-loading')) {\n                    self.buttonLoading($submitBtn,\n                        M.util.get_string('processingrequest', 'local_jobboard'));\n                }\n            });\n\n            // Handle AJAX button clicks\n            $(document).on('click', '[data-loading=\"true\"]', function() {\n                var $btn = $(this);\n                var loadingText = $btn.data('loading-text') ||\n                    M.util.get_string('loadinginprogress', 'local_jobboard');\n                self.buttonLoading($btn, loadingText);\n            });\n        }\n    };\n\n    return {\n        /**\n         * Add loading state to a button.\n         *\n         * @param {jQuery|string} button Button element or selector\n         * @param {string} loadingText Optional loading text\n         */\n        buttonLoading: function(button, loadingText) {\n            LoadingStates.buttonLoading(button, loadingText);\n        },\n\n        /**\n         * Remove loading state from a button.\n         *\n         * @param {jQuery|string} button Button element or selector\n         */\n        buttonReset: function(button) {\n            LoadingStates.buttonReset(button);\n        },\n\n        /**\n         * Add loading overlay to a container.\n         *\n         * @param {jQuery|string} container Container element or selector\n         */\n        containerLoading: function(container) {\n            LoadingStates.containerLoading(container);\n        },\n\n        /**\n         * Remove loading overlay from a container.\n         *\n         * @param {jQuery|string} container Container element or selector\n         */\n        containerReset: function(container) {\n            LoadingStates.containerReset(container);\n        },\n\n        /**\n         * Show skeleton loading placeholders.\n         *\n         * @param {jQuery|string} container Container element or selector\n         * @param {Object} options Skeleton options\n         */\n        showSkeleton: function(container, options) {\n            LoadingStates.showSkeleton(container, options);\n        },\n\n        /**\n         * Remove skeleton loading.\n         *\n         * @param {jQuery|string} container Container element or selector\n         * @param {string} newContent Optional new content\n         */\n        hideSkeleton: function(container, newContent) {\n            LoadingStates.hideSkeleton(container, newContent);\n        },\n\n        /**\n         * Initialize form handlers for automatic loading states.\n         */\n        init: function() {\n            LoadingStates.initFormHandlers();\n        }\n    };\n});\n"],"names":["define","$","LoadingStates","buttonLoading","button","loadingText","$btn","length","data","val","text","html","prop","addClass","is","buttonReset","removeClass","containerLoading","container","$container","containerReset","showSkeleton","options","extend","cards","type","i","j","k","hideSkeleton","newContent","undefined","initFormHandlers","self","this","document","on","$submitBtn","find","hasClass","M","util","get_string","init"],"mappings":";;;;;;;AAsBAA,uCAAO,CAAC,WAAW,SAASC,OAGpBC,cAAgB,CAOhBC,cAAe,SAASC,OAAQC,iBACxBC,KAAOL,EAAEG,QACRE,KAAKC,SAKVD,KAAKE,KAAK,gBAAiBF,KAAKG,OAASH,KAAKI,QAC9CJ,KAAKE,KAAK,gBAAiBF,KAAKK,QAChCL,KAAKE,KAAK,eAAgBF,KAAKM,KAAK,aAGpCN,KAAKO,SAAS,cACdP,KAAKM,KAAK,YAAY,GAElBP,cACIC,KAAKQ,GAAG,SACRR,KAAKG,IAAIJ,aAETC,KAAKK,KAAK,6CAA+CN,gBAUrEU,YAAa,SAASX,YACdE,KAAOL,EAAEG,QACRE,KAAKC,SAIVD,KAAKU,YAAY,cAGbV,KAAKQ,GAAG,SACRR,KAAKG,IAAIH,KAAKE,KAAK,kBAEnBF,KAAKK,KAAKL,KAAKE,KAAK,kBAGnBF,KAAKE,KAAK,iBACXF,KAAKM,KAAK,YAAY,KAS9BK,iBAAkB,SAASC,eACnBC,WAAalB,EAAEiB,WACdC,WAAWZ,QAIhBY,WAAWN,SAAS,kCAQxBO,eAAgB,SAASF,eACjBC,WAAalB,EAAEiB,WACdC,WAAWZ,QAIhBY,WAAWH,YAAY,kCAW3BK,aAAc,SAASH,UAAWI,aAC1BH,WAAalB,EAAEiB,cACdC,WAAWZ,YASZI,KAAO,MAEU,UAPrBW,QAAUrB,EAAEsB,OAAO,CACfC,MAAO,EACPC,KAAM,QACPH,UAISG,SACH,IAAIC,EAAI,EAAGA,EAAIJ,QAAQE,MAAOE,IAC/Bf,MAAQ,8BACRA,MAAQ,qBACRA,MAAQ,0BACRA,MAAQ,oDACRA,MAAQ,mDACRA,MAAQ,yDACRA,MAAQ,0BAET,GAAqB,SAAjBW,QAAQG,KAAiB,CAChCd,MAAQ,+BACH,IAAIgB,EAAI,EAAGA,EAAIL,QAAQE,MAAOG,IAC/BhB,MAAQ,gCACRA,MAAQ,0CACRA,MAAQ,0DACRA,MAAQ,4BACRA,MAAQ,sEACRA,MAAQ,yDACRA,MAAQ,qBAEZA,MAAQ,cACL,GAAqB,SAAjBW,QAAQG,SACV,IAAIG,EAAI,EAAGA,EAAIN,QAAQE,MAAOI,IAC/BjB,MAAQ,wDAIhBQ,WAAWX,KAAK,mBAAoBW,WAAWR,QAC/CQ,WAAWR,KAAKA,QASpBkB,aAAc,SAASX,UAAWY,gBAC1BX,WAAalB,EAAEiB,WACdC,WAAWZ,cAIGwB,IAAfD,WACAX,WAAWR,KAAKmB,YACTX,WAAWX,KAAK,qBACvBW,WAAWR,KAAKQ,WAAWX,KAAK,uBAOxCwB,iBAAkB,eACVC,KAAOC,KAGXjC,EAAEkC,UAAUC,GAAG,SAAU,cAAc,eAE/BC,WADQpC,EAAEiC,MACSI,KAAK,6CAExBD,WAAW9B,SAAW8B,WAAWE,SAAS,eAC1CN,KAAK9B,cAAckC,WACfG,EAAEC,KAAKC,WAAW,oBAAqB,sBAKnDzC,EAAEkC,UAAUC,GAAG,QAAS,yBAAyB,eACzC9B,KAAOL,EAAEiC,MACT7B,YAAcC,KAAKE,KAAK,iBACxBgC,EAAEC,KAAKC,WAAW,oBAAqB,kBAC3CT,KAAK9B,cAAcG,KAAMD,wBAK9B,CAOHF,cAAe,SAASC,OAAQC,aAC5BH,cAAcC,cAAcC,OAAQC,cAQxCU,YAAa,SAASX,QAClBF,cAAca,YAAYX,SAQ9Ba,iBAAkB,SAASC,WACvBhB,cAAce,iBAAiBC,YAQnCE,eAAgB,SAASF,WACrBhB,cAAckB,eAAeF,YASjCG,aAAc,SAASH,UAAWI,SAC9BpB,cAAcmB,aAAaH,UAAWI,UAS1CO,aAAc,SAASX,UAAWY,YAC9B5B,cAAc2B,aAAaX,UAAWY,aAM1Ca,KAAM,WACFzC,cAAc8B"}