{"version":3,"file":"apply_modal.min.js","sources":["../src/apply_modal.js"],"sourcesContent":["// This file is part of Moodle - http://moodle.org/\n//\n// Moodle is free software: you can redistribute it and/or modify\n// it under the terms of the GNU General Public License as published by\n// the Free Software Foundation, either version 3 of the License, or\n// (at your option) any later version.\n//\n// Moodle is distributed in the hope that it will be useful,\n// but WITHOUT ANY WARRANTY; without even the implied warranty of\n// MERCHANTABILITY or FITNESS FOR A PARTICULAR PURPOSE.  See the\n// GNU General Public License for more details.\n//\n// You should have received a copy of the GNU General Public License\n// along with Moodle.  If not, see <http://www.gnu.org/licenses/>.\n\n/**\n * AMD module for the apply modal popup.\n *\n * Shows a modal asking if the user is registered or not when attempting\n * to apply for a vacancy.\n *\n * @module     local_jobboard/apply_modal\n * @copyright  2024 ISER\n * @license    http://www.gnu.org/copyleft/gpl.html GNU GPL v3 or later\n */\ndefine(['jquery', 'core/modal_factory', 'core/modal_events', 'core/str', 'core/notification'],\n    function($, ModalFactory, ModalEvents, Str, Notification) {\n\n    /**\n     * Initialize the apply modal functionality.\n     *\n     * @param {number} vacancyId The vacancy ID.\n     * @param {string} vacancyTitle The vacancy title.\n     * @param {string} loginUrl The login URL.\n     * @param {string} signupUrl The signup URL.\n     */\n    var init = function(vacancyId, vacancyTitle, loginUrl, signupUrl) {\n        // Find all apply buttons.\n        $('.jobboard-apply-btn').on('click', function(e) {\n            e.preventDefault();\n\n            var btnVacancyId = $(this).data('vacancyid') || vacancyId;\n            var btnVacancyTitle = $(this).data('vacancytitle') || vacancyTitle;\n\n            showApplyModal(btnVacancyId, btnVacancyTitle, loginUrl, signupUrl);\n        });\n    };\n\n    /**\n     * Show the apply modal.\n     *\n     * @param {number} vacancyId The vacancy ID.\n     * @param {string} vacancyTitle The vacancy title.\n     * @param {string} loginUrl The login URL.\n     * @param {string} signupUrl The signup URL.\n     */\n    var showApplyModal = function(vacancyId, vacancyTitle, loginUrl, signupUrl) {\n        // Get all the strings we need.\n        var stringKeys = [\n            {key: 'apply_modal_title', component: 'local_jobboard'},\n            {key: 'apply_modal_question', component: 'local_jobboard'},\n            {key: 'apply_modal_registered', component: 'local_jobboard'},\n            {key: 'apply_modal_not_registered', component: 'local_jobboard'},\n            {key: 'apply_modal_registered_desc', component: 'local_jobboard'},\n            {key: 'apply_modal_not_registered_desc', component: 'local_jobboard'},\n            {key: 'cancel', component: 'core'}\n        ];\n\n        Str.get_strings(stringKeys).then(function(strings) {\n            var modalTitle = strings[0];\n            var modalQuestion = strings[1];\n            var registeredBtn = strings[2];\n            var notRegisteredBtn = strings[3];\n            var registeredDesc = strings[4];\n            var notRegisteredDesc = strings[5];\n            // strings[6] is 'cancel' - not used in current UI but kept for future use.\n\n            // Build modal body HTML.\n            var bodyHtml = '<div class=\"apply-modal-content text-center\">';\n            bodyHtml += '<p class=\"lead mb-4\">' + modalQuestion + '</p>';\n\n            // Registered option.\n            bodyHtml += '<div class=\"row\">';\n            bodyHtml += '<div class=\"col-md-6 mb-3\">';\n            bodyHtml += '<div class=\"card h-100\">';\n            bodyHtml += '<div class=\"card-body\">';\n            bodyHtml += '<i class=\"fa fa-user-check fa-3x text-success mb-3\"></i>';\n            bodyHtml += '<h5 class=\"card-title\">' + registeredBtn + '</h5>';\n            bodyHtml += '<p class=\"card-text small text-muted\">' + registeredDesc + '</p>';\n            bodyHtml += '<a href=\"' + loginUrl + '&vacancyid=' + vacancyId + '\" class=\"btn btn-success btn-block\">';\n            bodyHtml += '<i class=\"fa fa-sign-in me-2\"></i>' + registeredBtn + '</a>';\n            bodyHtml += '</div></div></div>';\n\n            // Not registered option.\n            bodyHtml += '<div class=\"col-md-6 mb-3\">';\n            bodyHtml += '<div class=\"card h-100\">';\n            bodyHtml += '<div class=\"card-body\">';\n            bodyHtml += '<i class=\"fa fa-user-plus fa-3x text-primary mb-3\"></i>';\n            bodyHtml += '<h5 class=\"card-title\">' + notRegisteredBtn + '</h5>';\n            bodyHtml += '<p class=\"card-text small text-muted\">' + notRegisteredDesc + '</p>';\n            bodyHtml += '<a href=\"' + signupUrl + '?vacancyid=' + vacancyId + '\" class=\"btn btn-primary btn-block\">';\n            bodyHtml += '<i class=\"fa fa-user-plus me-2\"></i>' + notRegisteredBtn + '</a>';\n            bodyHtml += '</div></div></div>';\n            bodyHtml += '</div></div>';\n\n            return ModalFactory.create({\n                type: ModalFactory.types.DEFAULT,\n                title: modalTitle,\n                body: bodyHtml,\n                large: true\n            });\n        }).then(function(modal) {\n            modal.getRoot().on(ModalEvents.hidden, function() {\n                modal.destroy();\n            });\n            modal.show();\n            return modal;\n        }).catch(Notification.exception);\n    };\n\n    return {\n        init: init,\n        showApplyModal: showApplyModal\n    };\n});\n"],"names":["define","$","ModalFactory","ModalEvents","Str","Notification","showApplyModal","vacancyId","vacancyTitle","loginUrl","signupUrl","get_strings","key","component","then","strings","modalTitle","modalQuestion","registeredBtn","notRegisteredBtn","registeredDesc","notRegisteredDesc","bodyHtml","create","type","types","DEFAULT","title","body","large","modal","getRoot","on","hidden","destroy","show","catch","exception","init","e","preventDefault","btnVacancyId","this","data","btnVacancyTitle"],"mappings":";;;;;;;;;;AAyBAA,oCAAO,CAAC,SAAU,qBAAsB,oBAAqB,WAAY,sBACrE,SAASC,EAAGC,aAAcC,YAAaC,IAAKC,kBA8BxCC,eAAiB,SAASC,UAAWC,aAAcC,SAAUC,WAY7DN,IAAIO,YAVa,CACb,CAACC,IAAK,oBAAqBC,UAAW,kBACtC,CAACD,IAAK,uBAAwBC,UAAW,kBACzC,CAACD,IAAK,yBAA0BC,UAAW,kBAC3C,CAACD,IAAK,6BAA8BC,UAAW,kBAC/C,CAACD,IAAK,8BAA+BC,UAAW,kBAChD,CAACD,IAAK,kCAAmCC,UAAW,kBACpD,CAACD,IAAK,SAAUC,UAAW,UAGHC,MAAK,SAASC,aAClCC,WAAaD,QAAQ,GACrBE,cAAgBF,QAAQ,GACxBG,cAAgBH,QAAQ,GACxBI,iBAAmBJ,QAAQ,GAC3BK,eAAiBL,QAAQ,GACzBM,kBAAoBN,QAAQ,GAI5BO,SAAW,uDACfA,UAAY,wBAA0BL,cAAgB,OAGtDK,UAAY,oBACZA,UAAY,8BACZA,UAAY,2BACZA,UAAY,0BACZA,UAAY,2DACZA,UAAY,0BAA4BJ,cAAgB,QACxDI,UAAY,yCAA2CF,eAAiB,OACxEE,UAAY,YAAcb,SAAW,cAAgBF,UAAY,uCACjEe,UAAY,qCAAuCJ,cAAgB,OACnEI,UAAY,qBAGZA,UAAY,8BACZA,UAAY,2BACZA,UAAY,0BACZA,UAAY,0DACZA,UAAY,0BAA4BH,iBAAmB,QAC3DG,UAAY,yCAA2CD,kBAAoB,OAC3EC,UAAY,YAAcZ,UAAY,cAAgBH,UAAY,uCAClEe,UAAY,uCAAyCH,iBAAmB,OACxEG,UAAY,qBACZA,UAAY,eAELpB,aAAaqB,OAAO,CACvBC,KAAMtB,aAAauB,MAAMC,QACzBC,MAAOX,WACPY,KAAMN,SACNO,OAAO,OAEZf,MAAK,SAASgB,cACbA,MAAMC,UAAUC,GAAG7B,YAAY8B,QAAQ,WACnCH,MAAMI,aAEVJ,MAAMK,OACCL,SACRM,MAAM/B,aAAagC,kBAGnB,CACHC,KArFO,SAAS/B,UAAWC,aAAcC,SAAUC,WAEnDT,EAAE,uBAAuB+B,GAAG,SAAS,SAASO,GAC1CA,EAAEC,qBAEEC,aAAexC,EAAEyC,MAAMC,KAAK,cAAgBpC,UAC5CqC,gBAAkB3C,EAAEyC,MAAMC,KAAK,iBAAmBnC,aAEtDF,eAAemC,aAAcG,gBAAiBnC,SAAUC,eA8E5DJ,eAAgBA"}