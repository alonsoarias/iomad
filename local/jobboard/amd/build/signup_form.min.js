/**
 * AMD module for signup form with dynamic department loading.
 *
 * @module     local_jobboard/signup_form
 * @copyright  2024 ISER
 * @license    http://www.gnu.org/copyleft/gpl.html GNU GPL v3 or later
 */
define(["jquery","core/ajax","core/notification","core/str"],function(e,t,n,a){return{init:function(){var t=e('select[name="companyid"]'),n=e('select[name="departmentid"]');if(t.length||(t=e('#id_companyid_signup, [id$="_companyid"]').first()),n.length||(n=e('#id_departmentid_signup, [id$="_departmentid"]').first()),t.length&&n.length){console.log("JobBoard signup_form: Initialized with",t.attr("id"),n.attr("id"));var o=function(t){n.empty(),t&&"0"!==t?(n.prop("disabled",!0),a.get_string("loading","local_jobboard").done(function(t){n.append(e("<option>",{value:0,text:t+"..."}))}),e.ajax({url:M.cfg.wwwroot+"/local/jobboard/ajax/get_departments.php",method:"GET",data:{companyid:parseInt(t,10)},dataType:"json"}).done(function(t){n.empty(),n.prop("disabled",!1),a.get_string("selectdepartment","local_jobboard").done(function(a){n.append(e("<option>",{value:0,text:a})),t.success&&t.departments&&t.departments.length>0&&e.each(t.departments,function(t,a){n.append(e("<option>",{value:a.id,text:a.name}))})}).fail(function(){n.append(e("<option>",{value:0,text:"Select department..."})),t.success&&t.departments&&t.departments.length>0&&e.each(t.departments,function(t,a){n.append(e("<option>",{value:a.id,text:a.name}))})})}).fail(function(t,o,i){n.empty(),n.prop("disabled",!1),a.get_string("selectdepartment","local_jobboard").done(function(t){n.append(e("<option>",{value:0,text:t}))}).fail(function(){n.append(e("<option>",{value:0,text:"Select department..."}))}),console.error("Error loading departments:",o,i)})):a.get_string("selectdepartment","local_jobboard").done(function(t){n.append(e("<option>",{value:0,text:t}))})};t.on("change",function(){var t=e(this).val();o(t)});var i=t.val();i&&"0"!==i&&o(i);var s=e("#id_password");if(s.length){var l=e("<div>",{class:"password-strength mt-1",id:"password-strength"});s.after(l),s.on("keyup",function(){var t=e(this).val(),n=d(t);r(n)})}var d=function(e){var t={score:0,level:"weak"};return e?(e.length>=8&&(t.score+=1),e.length>=12&&(t.score+=1),/[a-z]/.test(e)&&(t.score+=1),/[A-Z]/.test(e)&&(t.score+=1),/[0-9]/.test(e)&&(t.score+=1),/[^a-zA-Z0-9]/.test(e)&&(t.score+=1),t.score>=5?t.level="strong":t.score>=3?t.level="medium":t.level="weak",t):t},r=function(t){var n=e("#password-strength"),o={weak:"danger",medium:"warning",strong:"success"};a.get_string("password_strength_"+t.level,"local_jobboard").done(function(e){n.html('<small class="text-'+o[t.level]+'"><i class="fa fa-shield me-1"></i>'+e+"</small>")}).fail(function(){n.html('<small class="text-'+o[t.level]+'"><i class="fa fa-shield me-1"></i>'+t.level+"</small>")})},c=e("#id_email"),p=e("#id_email2");c.length&&p.length&&p.on("blur",function(){var t=c.val(),n=e(this).val();t&&n&&t!==n?(e(this).addClass("is-invalid"),a.get_string("emailnotmatch","local_jobboard").done(function(t){e(this).siblings(".invalid-feedback").length||e(this).after('<div class="invalid-feedback">'+t+"</div>")}.bind(this))):(e(this).removeClass("is-invalid"),e(this).siblings(".invalid-feedback").remove())})}else console.log("JobBoard signup_form: Company or department selects not found")}}});
//# sourceMappingURL=signup_form.min.js.map