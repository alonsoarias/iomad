/**
 * AMD module for public filters with dynamic department loading.
 *
 * @module     local_jobboard/public_filters
 * @copyright  2024 ISER
 * @license    http://www.gnu.org/copyleft/gpl.html GNU GPL v3 or later
 */
define("local_jobboard/public_filters",["jquery"],(function($){var loadDepartments=function(departmentSelect,companyId,preselect,allLabel){departmentSelect.empty(),departmentSelect.append($("<option>",{value:0,text:allLabel||"Todas las modalidades"})),companyId&&"0"!==companyId&&0!==companyId&&(departmentSelect.prop("disabled",!0),$.ajax({url:M.cfg.wwwroot+"/local/jobboard/ajax/get_departments.php",method:"GET",data:{companyid:parseInt(companyId,10)},dataType:"json"}).done((function(response){departmentSelect.empty(),departmentSelect.prop("disabled",!1),departmentSelect.append($("<option>",{value:0,text:allLabel||"Todas las modalidades"})),response.success&&response.departments&&response.departments.length>0&&$.each(response.departments,(function(index,dept){var option=$("<option>",{value:dept.id,text:dept.name});preselect&&parseInt(preselect,10)===parseInt(dept.id,10)&&option.prop("selected",!0),departmentSelect.append(option)}))})).fail((function(jqXHR,textStatus,errorThrown){departmentSelect.empty(),departmentSelect.prop("disabled",!1),departmentSelect.append($("<option>",{value:0,text:allLabel||"Todas las modalidades"})),console.error("Error loading departments:",textStatus,errorThrown)})))};return{init:function(options){var companySelect=$((options=options||{}).companySelector||"#filter-companyid"),departmentSelect=$(options.departmentSelector||"#filter-departmentid"),allLabel=options.allLabel||"Todas las modalidades";if(companySelect.length&&departmentSelect.length){console.log("JobBoard public_filters: Initialized"),companySelect.on("change",(function(){var companyId=$(this).val();loadDepartments(departmentSelect,companyId,null,allLabel)}));var initialCompany=companySelect.val();initialCompany&&"0"!==initialCompany&&0!==initialCompany&&loadDepartments(departmentSelect,initialCompany,options.preselect,allLabel)}else console.log("JobBoard public_filters: Company or department selects not found")},loadDepartments:loadDepartments}}));

//# sourceMappingURL=public_filters.min.js.map