{"version":3,"file":"confirm_action.min.js","sources":["../src/confirm_action.js"],"sourcesContent":["// This file is part of Moodle - http://moodle.org/\n//\n// Moodle is free software: you can redistribute it and/or modify\n// it under the terms of the GNU General Public License as published by\n// the Free Software Foundation, either version 3 of the License, or\n// (at your option) any later version.\n//\n// Moodle is distributed in the hope that it will be useful,\n// but WITHOUT ANY WARRANTY; without even the implied warranty of\n// MERCHANTABILITY or FITNESS FOR A PARTICULAR PURPOSE.  See the\n// GNU General Public License for more details.\n//\n// You should have received a copy of the GNU General Public License\n// along with Moodle.  If not, see <http://www.gnu.org/licenses/>.\n\n/**\n * AMD module for confirmation dialogs.\n *\n * Replaces inline onclick=\"return confirm()\" with accessible modal dialogs.\n * Uses Moodle's core/notification module for consistent modal styling.\n *\n * @module     local_jobboard/confirm_action\n * @copyright  2024 ISER\n * @license    http://www.gnu.org/copyleft/gpl.html GNU GPL v3 or later\n */\ndefine(['jquery', 'core/notification', 'core/str'], function($, Notification, Str) {\n    'use strict';\n\n    /**\n     * Initialize confirmation handlers for elements with data-confirm attribute.\n     *\n     * @param {Object} options Configuration options.\n     * @param {string} options.selector Selector for confirm elements.\n     */\n    var init = function(options) {\n        options = options || {};\n\n        var selector = options.selector || '[data-confirm]';\n\n        // Handle click events on elements with data-confirm attribute.\n        $(document).on('click', selector, function(e) {\n            var $el = $(this);\n            var confirmMessage = $el.data('confirm');\n\n            if (!confirmMessage) {\n                return true;\n            }\n\n            e.preventDefault();\n            e.stopPropagation();\n\n            var href = $el.attr('href');\n            var isForm = $el.is('button') && $el.closest('form').length > 0;\n\n            // Get the confirmation title from data attribute or use default.\n            var titleKey = $el.data('confirm-title') || 'confirm';\n\n            Str.get_string(titleKey, 'moodle').then(function(title) {\n                return Notification.confirm(\n                    title,\n                    confirmMessage,\n                    Str.get_string('yes'),\n                    Str.get_string('no'),\n                    function() {\n                        if (isForm) {\n                            // Submit the form.\n                            $el.closest('form').submit();\n                        } else if (href) {\n                            // Navigate to the href.\n                            window.location.href = href;\n                        }\n                    }\n                );\n            }).catch(function() {\n                // Fallback to browser confirm if string loading fails.\n                if (window.confirm(confirmMessage)) {\n                    if (isForm) {\n                        $el.closest('form').submit();\n                    } else if (href) {\n                        window.location.href = href;\n                    }\n                }\n            });\n\n            return false;\n        });\n    };\n\n    /**\n     * Show a confirmation dialog programmatically.\n     *\n     * @param {string} message The confirmation message.\n     * @param {Function} onConfirm Callback when confirmed.\n     * @param {Function} onCancel Optional callback when cancelled.\n     * @param {string} title Optional dialog title.\n     */\n    var confirm = function(message, onConfirm, onCancel, title) {\n        title = title || 'Confirm';\n\n        Notification.confirm(\n            title,\n            message,\n            Str.get_string('yes'),\n            Str.get_string('no'),\n            function() {\n                if (typeof onConfirm === 'function') {\n                    onConfirm();\n                }\n            },\n            function() {\n                if (typeof onCancel === 'function') {\n                    onCancel();\n                }\n            }\n        );\n    };\n\n    return {\n        init: init,\n        confirm: confirm\n    };\n});\n"],"names":["define","$","Notification","Str","init","options","selector","document","on","e","$el","this","confirmMessage","data","preventDefault","stopPropagation","href","attr","isForm","is","closest","length","titleKey","get_string","then","title","confirm","submit","window","location","catch","message","onConfirm","onCancel"],"mappings":";;;;;;;;;;AAyBAA,uCAAO,CAAC,SAAU,oBAAqB,aAAa,SAASC,EAAGC,aAAcC,WA4FnE,CACHC,KApFO,SAASC,aAGZC,UAFJD,QAAUA,SAAW,IAEEC,UAAY,iBAGnCL,EAAEM,UAAUC,GAAG,QAASF,UAAU,SAASG,OACnCC,IAAMT,EAAEU,MACRC,eAAiBF,IAAIG,KAAK,eAEzBD,sBACM,EAGXH,EAAEK,iBACFL,EAAEM,sBAEEC,KAAON,IAAIO,KAAK,QAChBC,OAASR,IAAIS,GAAG,WAAaT,IAAIU,QAAQ,QAAQC,OAAS,EAG1DC,SAAWZ,IAAIG,KAAK,kBAAoB,iBAE5CV,IAAIoB,WAAWD,SAAU,UAAUE,MAAK,SAASC,cACtCvB,aAAawB,QAChBD,MACAb,eACAT,IAAIoB,WAAW,OACfpB,IAAIoB,WAAW,OACf,WACQL,OAEAR,IAAIU,QAAQ,QAAQO,SACbX,OAEPY,OAAOC,SAASb,KAAOA,YAIpCc,OAAM,WAEDF,OAAOF,QAAQd,kBACXM,OACAR,IAAIU,QAAQ,QAAQO,SACbX,OACPY,OAAOC,SAASb,KAAOA,WAK5B,MAmCXU,QAvBU,SAASK,QAASC,UAAWC,SAAUR,OACjDA,MAAQA,OAAS,UAEjBvB,aAAawB,QACTD,MACAM,QACA5B,IAAIoB,WAAW,OACfpB,IAAIoB,WAAW,OACf,WAC6B,mBAAdS,WACPA,eAGR,WAC4B,mBAAbC,UACPA"}