{"version":3,"file":"public_filters.min.js","sources":["../src/public_filters.js"],"sourcesContent":["// This file is part of Moodle - http://moodle.org/\n//\n// Moodle is free software: you can redistribute it and/or modify\n// it under the terms of the GNU General Public License as published by\n// the Free Software Foundation, either version 3 of the License, or\n// (at your option) any later version.\n//\n// Moodle is distributed in the hope that it will be useful,\n// but WITHOUT ANY WARRANTY; without even the implied warranty of\n// MERCHANTABILITY or FITNESS FOR A PARTICULAR PURPOSE.  See the\n// GNU General Public License for more details.\n//\n// You should have received a copy of the GNU General Public License\n// along with Moodle.  If not, see <http://www.gnu.org/licenses/>.\n\n/**\n * AMD module for public filters with dynamic company and department loading.\n *\n * This module handles AJAX-based filtering for public pages using the\n * company_loader and department_loader modules for consistent behavior.\n *\n * @module     local_jobboard/public_filters\n * @copyright  2024 ISER\n * @license    http://www.gnu.org/copyleft/gpl.html GNU GPL v3 or later\n */\ndefine([\n    'jquery',\n    'local_jobboard/department_loader',\n    'local_jobboard/company_loader'\n], function($, DepartmentLoader, CompanyLoader) {\n    'use strict';\n\n    /**\n     * Load departments for a given company (wrapper for backward compatibility).\n     *\n     * @param {jQuery} departmentSelect The department select element.\n     * @param {number} companyId The company ID.\n     * @param {number} preselect Optional department ID to preselect.\n     * @param {string} allLabel Label for \"All\" option.\n     */\n    var loadDepartments = function(departmentSelect, companyId, preselect, allLabel) {\n        DepartmentLoader.loadDepartments(departmentSelect, companyId, preselect, allLabel);\n    };\n\n    /**\n     * Initialize the public filters handlers.\n     *\n     * @param {Object} options Configuration options.\n     * @param {string} options.companySelector Selector for company element.\n     * @param {string} options.departmentSelector Selector for department element.\n     * @param {number} options.preselect Optional department ID to preselect.\n     * @param {string} options.allLabel Label for \"All\" option.\n     * @param {boolean} options.loadCompaniesAjax Whether to load companies via AJAX.\n     */\n    var init = function(options) {\n        options = options || {};\n\n        var companySelector = options.companySelector || '#filter-companyid';\n        var departmentSelector = options.departmentSelector || '#filter-departmentid';\n        var allLabel = options.allLabel || 'Todas las modalidades';\n\n        var companySelect = $(companySelector);\n        var departmentSelect = $(departmentSelector);\n\n        // Exit if elements not found.\n        if (!companySelect.length || !departmentSelect.length) {\n            // eslint-disable-next-line no-console\n            console.log('JobBoard public_filters: Company or department selects not found');\n            return;\n        }\n\n        // eslint-disable-next-line no-console\n        console.log('JobBoard public_filters: Initialized');\n\n        // Use company_loader for AJAX loading if enabled.\n        if (options.loadCompaniesAjax) {\n            CompanyLoader.initFilter({\n                companySelector: companySelector,\n                departmentSelector: departmentSelector,\n                departmentPreselect: options.preselect,\n                allDepartmentsLabel: allLabel\n            });\n        } else {\n            // Handle company change to load departments.\n            companySelect.on('change', function() {\n                var companyId = $(this).val();\n                loadDepartments(departmentSelect, companyId, null, allLabel);\n            });\n\n            // Load departments if company is pre-selected.\n            var initialCompany = companySelect.val();\n            if (initialCompany && initialCompany !== '0' && initialCompany !== 0) {\n                loadDepartments(departmentSelect, initialCompany, options.preselect, allLabel);\n            }\n        }\n    };\n\n    return {\n        init: init,\n        loadDepartments: loadDepartments\n    };\n});\n"],"names":["define","$","DepartmentLoader","CompanyLoader","loadDepartments","departmentSelect","companyId","preselect","allLabel","init","options","companySelector","departmentSelector","companySelect","length","console","log","loadCompaniesAjax","initFilter","departmentPreselect","allDepartmentsLabel","on","this","val","initialCompany"],"mappings":";;;;;;;;;;AAyBAA,uCAAO,CACH,SACA,mCACA,kCACD,SAASC,EAAGC,iBAAkBC,mBAWzBC,gBAAkB,SAASC,iBAAkBC,UAAWC,UAAWC,UACnEN,iBAAiBE,gBAAgBC,iBAAkBC,UAAWC,UAAWC,iBAwDtE,CACHC,KA5CO,SAASC,aAGZC,iBAFJD,QAAUA,SAAW,IAESC,iBAAmB,oBAC7CC,mBAAqBF,QAAQE,oBAAsB,uBACnDJ,SAAWE,QAAQF,UAAY,wBAE/BK,cAAgBZ,EAAEU,iBAClBN,iBAAmBJ,EAAEW,uBAGpBC,cAAcC,QAAWT,iBAAiBS,UAO/CC,QAAQC,IAAI,wCAGRN,QAAQO,kBACRd,cAAce,WAAW,CACrBP,gBAAiBA,gBACjBC,mBAAoBA,mBACpBO,oBAAqBT,QAAQH,UAC7Ba,oBAAqBZ,eAEtB,CAEHK,cAAcQ,GAAG,UAAU,eACnBf,UAAYL,EAAEqB,MAAMC,MACxBnB,gBAAgBC,iBAAkBC,UAAW,KAAME,iBAInDgB,eAAiBX,cAAcU,MAC/BC,gBAAqC,MAAnBA,gBAA6C,IAAnBA,gBAC5CpB,gBAAgBC,iBAAkBmB,eAAgBd,QAAQH,UAAWC,eAzBzEO,QAAQC,IAAI,qEAgChBZ,gBAAiBA"}